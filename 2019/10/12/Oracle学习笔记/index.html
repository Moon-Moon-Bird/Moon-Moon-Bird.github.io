<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="1.Oracle体系结构 数据库Oracle数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。  实例一个Oracle实例（Oracle Instance）有一系列的后台进程（Backguound Processes)和内存结构（">
<meta name="keywords" content="Oracle">
<meta property="og:type" content="article">
<meta property="og:title" content="Oracle学习笔记">
<meta property="og:url" content="http://yoursite.com/2019/10/12/Oracle学习笔记/index.html">
<meta property="og:site_name" content="月月鸟的个人博客">
<meta property="og:description" content="1.Oracle体系结构 数据库Oracle数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。  实例一个Oracle实例（Oracle Instance）有一系列的后台进程（Backguound Processes)和内存结构（">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://i.loli.net/2019/10/12/zZtdCAkBH92FsmS.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/nd9pfuKFAZsyNqR.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/MX7J3xNrCaVo4jK.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/JOCK1AWyc8TQXzj.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/ZdfAQt6k4eyBNzG.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/1wcTNv4GbS6eZpU.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/VHrnIFP2Byog1cT.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/WSlq4Jr3DOQcGIv.png">
<meta property="og:image" content="https://i.loli.net/2019/10/12/Wqlht5fTuSRVPMg.png">
<meta property="og:updated_time" content="2019-10-12T10:09:30.399Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Oracle学习笔记">
<meta name="twitter:description" content="1.Oracle体系结构 数据库Oracle数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。  实例一个Oracle实例（Oracle Instance）有一系列的后台进程（Backguound Processes)和内存结构（">
<meta name="twitter:image" content="https://i.loli.net/2019/10/12/zZtdCAkBH92FsmS.png">
  <link rel="canonical" href="http://yoursite.com/2019/10/12/Oracle学习笔记/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Oracle学习笔记 | 月月鸟的个人博客</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
		<a href="https://github.com/Moon-Moon-Bird" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">月月鸟的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
        
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      
    
      
      
        
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      
    
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">
        
          <i class="fa fa-search fa-fw"></i>
        
        搜索
        </a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/12/Oracle学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="月月鸟">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="月月鸟的个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            Oracle学习笔记
            

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-10-12 18:02:29 / 修改时间：18:09:30" itemprop="dateCreated datePublished" datetime="2019-10-12T18:02:29+08:00">2019-10-12</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据库/" itemprop="url" rel="index">
                    <span itemprop="name">数据库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/10/12/Oracle学习笔记/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/10/12/Oracle学习笔记/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">本文字数：</span>
              
              <span>16k</span>
            </span>
          
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              
              <span>15 分钟</span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-Oracle体系结构"><a href="#1-Oracle体系结构" class="headerlink" title="1.Oracle体系结构"></a>1.Oracle体系结构</h1><ol>
<li><p>数据库<br>Oracle数据库是数据的物理存储。这就包括（数据文件ORA或者DBF、控制文件、联机日志、参数文件）。其实Oracle数据库的概念和其它数据库不一样，这里的数据库是一个操作系统只有一个库。可以看作是Oracle就只有一个大数据库。</p>
</li>
<li><p>实例<br>一个Oracle实例（Oracle Instance）有一系列的后台进程（Backguound Processes)和内存结构（Memory Structures)组成。一个数据库可以有n个实例。</p>
</li>
<li><p>用户<br>用户是在实例下建立的。不同实例可以建相同名字的用户。(相当于mysql的数据库)</p>
</li>
</ol><a id="more"></a>
<ol start="4">
<li>表空间<br>表空间是Oracle对物理数据库上相关数据文件（ORA或者DBF文件）的逻辑映射。一个数据库在逻辑上被划分成一到若干个表空间，每个表空间包含了在逻辑上相关联的一组结构。每个数据库至少有一个表空间(称之为system表空间)。 每个表空间由同一磁盘上的一个或多个文件组成，这些文件叫数据文件(datafile)。一个数据文件只能属于一个表空间。<br><img src="https://i.loli.net/2019/10/12/zZtdCAkBH92FsmS.png" alt="1.png"></li>
</ol>
<ol start="5">
<li>数据文件（dbf、ora）<br>数据文件是数据库的物理存储单位。数据库的数据是存储在表空间中的，真正是在某一个或者多个数据文件中。而一个表空间可以由一个或多个数据文件组成，一个数据文件只能属于一个表空间。一旦数据文件被加入到某个表空间后，就不能删除这个文件，如果要删除某个数据文件，只能删除其所属于的表空间才行。<br><img src="https://i.loli.net/2019/10/12/nd9pfuKFAZsyNqR.png" alt="2.png"><br><img src="https://i.loli.net/2019/10/12/MX7J3xNrCaVo4jK.png" alt="3.png"></li>
</ol>
<h1 id="2-表空间与用户的创建"><a href="#2-表空间与用户的创建" class="headerlink" title="2.表空间与用户的创建"></a>2.表空间与用户的创建</h1><pre><code>--创建表空间
create tablespace kobe
datafile &apos;d:\kobe.dbf&apos;
size 100m
autoextend on
next 10m;

--删除表空间
drop tablespace kobe;

--创建用户
create user kobe
identified by kobe
default tablespace kobe;

--给用户授权
--oracle数据库中常用角色
connect --连接角色,基本角色
resource --开发者角色
dba --超级管理员角色

--给kobe用户授予dba角色
grant dba to kobe;

--切换到kobe用户下</code></pre><h1 id="3-Oracle数据类型"><a href="#3-Oracle数据类型" class="headerlink" title="3.Oracle数据类型"></a>3.Oracle数据类型</h1><h2 id="Varchar，-varchar2"><a href="#Varchar，-varchar2" class="headerlink" title="Varchar， varchar2"></a>Varchar， varchar2</h2><p>表示一个字符串</p>
<h2 id="NUMBER"><a href="#NUMBER" class="headerlink" title="NUMBER"></a>NUMBER</h2><p>NUMBER(n)表示一个整数，长度是n<br>NUMBER(m,n):表示一个小数，总长度是m，小数是n，整数是m-n</p>
<h2 id="DATA"><a href="#DATA" class="headerlink" title="DATA"></a>DATA</h2><p>表示日期类型</p>
<h2 id="CLOB"><a href="#CLOB" class="headerlink" title="CLOB"></a>CLOB</h2><p>大对象，表示大文本数据类型，可存4G</p>
<h2 id="BLOB"><a href="#BLOB" class="headerlink" title="BLOB"></a>BLOB</h2><p>大对象，表示二进制数据，可存4G</p>
<h1 id="4-表的管理"><a href="#4-表的管理" class="headerlink" title="4.表的管理"></a>4.表的管理</h1><h2 id="表的创建"><a href="#表的创建" class="headerlink" title="表的创建"></a>表的创建</h2><p>语法：</p>
<pre><code>Create table 表名（
字段1 数据类型 [default 默认值],
字段2 数据类型 [default 默认值],
...
字段n 数据类型 [default 默认值]
）;</code></pre><p>范例：创建person表 </p>
<pre><code>create table person( 
    pid number(10), 
    name varchar2(10), 
);</code></pre><p>表结构的修改:</p>
<pre><code>--添加一列
alter table person add (gender number(1));

--修改列类型
alter table person modify gender char(1);

--修改列名称
alter table person rename column gender to sex;

--删除一列
alter table person drop column sex;</code></pre><h2 id="表的增删改"><a href="#表的增删改" class="headerlink" title="表的增删改"></a>表的增删改</h2><pre><code>--添加一条记录
insert into person (pid,pname) values (1,&apos;张三&apos;);
commit;

--修改一条记录
update person set pname = &apos;李四&apos; where pid = 1;
commit;

--三种删除
--删除表中全部记录
delete from person;

--删除表结构
drop table person;

--先删除表,再次创建表.效果等于删除表中全部记录
--在数据量大的情况下,尤其在表中带有索引的情况下,该操作效率高
--索引可以提高查询效率,但会影响增删改效率
truncate table person;</code></pre><h1 id="5-序列"><a href="#5-序列" class="headerlink" title="5.序列"></a>5.序列</h1><p> 序列不真的属于任何一张表,但是可以逻辑和表做绑定<br> 序列:默认从1开始,依次递增,主要用来给主键赋值使用<br> dual:续表,只是为了补全语法,没有意义  </p>
<pre><code>create sequence s_person;
select s_person.nextval from dual;
--nextval :取得序列的下一个内容
--currval :取得序列的当前内容 </code></pre><p>在插入数据时需要自增的主键中可以这样使用</p>
<pre><code>--添加一条记录
insert into person (pid,pname) values (s_person.nextval,&apos;张三&apos;);
commit;</code></pre><h1 id="6-Scott用户下的表结构"><a href="#6-Scott用户下的表结构" class="headerlink" title="6.Scott用户下的表结构"></a>6.Scott用户下的表结构</h1><p>用户名:scott<br>密码:tiger</p>
<pre><code>--解锁scott用户(超级管理员权限)
alter user scott account unlock;
--解锁scott用户的密码[此句也可以用来重置密码]
alter user scott identified by tiger;</code></pre><h1 id="7-单行函数"><a href="#7-单行函数" class="headerlink" title="7.单行函数"></a>7.单行函数</h1><p>单行函数:作用于一行,返回一个值<br>多行函数:作用于多行,返回一个值</p>
<h2 id="7-1-字符函数"><a href="#7-1-字符函数" class="headerlink" title="7.1 字符函数"></a>7.1 字符函数</h2><pre><code>select upper(&apos;yes&apos;) from dual; --小写变大写
select lower(&apos;YES&apos;) from dual; --大写变小写</code></pre><h2 id="7-2-数值函数"><a href="#7-2-数值函数" class="headerlink" title="7.2 数值函数"></a>7.2 数值函数</h2><pre><code>select round(26.18,1) from dual; --四舍五入,后面的参数表示保留的小数位数
select trunc(56.16,-1) from dual; --直接截取,不四舍五入
select mod(10,3) from dual; --求余数</code></pre><h2 id="7-3-日期函数"><a href="#7-3-日期函数" class="headerlink" title="7.3 日期函数"></a>7.3 日期函数</h2><pre><code>--查询出emp表中所有员工入职距离现在几天
select sysdate-e.hiredate from emp e;

--算出明天此刻
select sysdate+1 from dual;

--查询出emp表中所有员工入职距离现在几月
select months_between(sysdate,e.hiredate) from emp e;

--查询出emp表中所有员工入职距离现在几年
select months_between(sysdate,e.hiredate)/12 from emp e;

--查询出emp表中所有员工入职距离现在几周
select round((sysdate-e.hiredate)/7) from emp e;</code></pre><h2 id="7-4-转换函数"><a href="#7-4-转换函数" class="headerlink" title="7.4 转换函数"></a>7.4 转换函数</h2><pre><code>--日期转为字符串
select to_char(sysdate,&apos;fm yyyy-mm-dd- hh:mi:ss&apos;) from dual;

--24小时计数法
select to_char(sysdate,&apos;fm yyyy-mm-dd- hh24:mi:ss&apos;) from dual;

--字符串转为日期
select to_date( &apos;2019-9-16- 21:39:54&apos;,&apos;fm yyyy-mm-dd- hh24:mi:ss&apos;) from dual;</code></pre><h2 id="7-5-通用函数"><a href="#7-5-通用函数" class="headerlink" title="7.5 通用函数"></a>7.5 通用函数</h2><pre><code>--算出emp表中所有员工的年薪
--奖金里有null值,null与任意数做运算结果都为null
select e.sal*12+nvl(e.comm,0) from emp e;</code></pre><p>–nvl(值1,值2):如果值1为null,计算用值2代替</p>
<h2 id="7-6-条件表达式"><a href="#7-6-条件表达式" class="headerlink" title="7.6 条件表达式"></a>7.6 条件表达式</h2><h3 id="通用写法-mysql和Oracle通用"><a href="#通用写法-mysql和Oracle通用" class="headerlink" title="通用写法(mysql和Oracle通用)"></a>通用写法(mysql和Oracle通用)</h3><p>–给emp表中员工起中文名</p>
<pre><code>select e.ename, 
       case e.ename
         when &apos;SMITH&apos; then &apos;科比&apos;
           when &apos;ALLEN&apos; then &apos;雷阿伦&apos;
             when &apos;WARD&apos; then &apos;韦德&apos;
               else &apos;无名&apos;
                 end
from emp e;</code></pre><p>–判断emp表中员工工资,如果高于3000显示高收入,高于1500低于3000,显示中等,<br>–其余显示低收入</p>
<pre><code>select e.ename, 
       case 
         when e.sal&gt;3000 then &apos;高收入&apos;
           when e.sal&gt;1500 then &apos;中等收入&apos;
               else &apos;低收入&apos;
                 end
from emp e;</code></pre><h2 id="Oracle专用表达式"><a href="#Oracle专用表达式" class="headerlink" title="Oracle专用表达式"></a>Oracle专用表达式</h2><p>Oracle中除了起别名,都用单引号  </p>
<pre><code>select e.ename, 
       decode(e.ename,
         &apos;SMITH&apos;,&apos;科比&apos;,
           &apos;ALLEN&apos;,&apos;雷阿伦&apos;,
             &apos;WARD&apos;,&apos;韦德&apos;,
               &apos;无名&apos;) 中文名
from emp e;</code></pre><h1 id="8-多行函数-聚合函数"><a href="#8-多行函数-聚合函数" class="headerlink" title="8.多行函数(聚合函数)"></a>8.多行函数(聚合函数)</h1><pre><code>select count(1) from emp;--查询总数量
--count(1)相当于count(主键)
select sum(sal) from emp;--工资总和
select max(sal) from emp;--最高工资
select min(sal) from emp;--最低工资
select avg(sal) from emp;--平均工资</code></pre><h1 id="9-分组查询"><a href="#9-分组查询" class="headerlink" title="9.分组查询"></a>9.分组查询</h1><p>先写</p>
<pre><code>select
from
group</code></pre><p>再补全查询内容</p>
<p><strong>查询出每个部门的平均工资</strong></p>
<pre><code>--分组查询中,出现在group by后面的原始列,才能出现在select后面
--没有出现在group by后面的列,想在select后面,必须加上聚合函数
--聚合函数的特性:把多行记录变成一个值
select e.deptno,avg(e.sal)
from emp e
group by e.deptno;</code></pre><p><strong>查询出平均工资高于2000的部门信息</strong></p>
<pre><code>select e.deptno,avg(e.sal)
from emp e,dept d
group by e.deptno
having avg(e.sal)&gt;2000;
--所有条件都不能使用别名来判断(where执行优于select)</code></pre><p><strong>查询出每个部门工资高于800的员工的平均工资</strong></p>
<pre><code>select e.deptno,avg(e.sal)
from emp e
where e.sal&gt;800
group by e.deptno;
--where是过滤分组前的数据,having是过滤分组后的数据
--表现形式:where必须在group by之前.having在group by之后</code></pre><p><strong>查询出每个部门工资高于800的员工的平均工资</strong><br><strong>再查询出平均工资高于2000的部门</strong></p>
<pre><code>select e.deptno,avg(e.sal)
from emp e
where e.sal&gt;800
group by e.deptno
having avg(e.sal)&gt;2000;</code></pre><h2 id="重点-where是过滤分组前的数据-having是过滤分组后的数据"><a href="#重点-where是过滤分组前的数据-having是过滤分组后的数据" class="headerlink" title="重点:where是过滤分组前的数据,having是过滤分组后的数据"></a>重点:where是过滤分组前的数据,having是过滤分组后的数据</h2><h1 id="10-多表查询中的一些概念"><a href="#10-多表查询中的一些概念" class="headerlink" title="10. 多表查询中的一些概念"></a>10. 多表查询中的一些概念</h1><h2 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h2><pre><code>select * 
from emp e inner join dept d
on e.deptno=d.deptno;</code></pre><h2 id="等值连接"><a href="#等值连接" class="headerlink" title="等值连接"></a>等值连接</h2><pre><code>select *
from emp e,dept d
where e.deptno=d.deptno;</code></pre><h2 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h2><pre><code>select * 
from emp e inner join dept d
on e.deptno=d.deptno;</code></pre><h2 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h2><pre><code>--查询出所有部门,以及部门下的员工信息(外连接)
--右外连接(右表在左侧)
select *
from emp e right join dept d
on e.deptno=d.deptno;

--查询所有员工信息,以及员工所属部门信息
--左外连接(左表在左侧)
select *
from emp e left join dept d
on e.deptno=d.deptno;</code></pre><h2 id="oracle中专用外连接"><a href="#oracle中专用外连接" class="headerlink" title="oracle中专用外连接"></a>oracle中专用外连接</h2><pre><code>--加号在哪边,另一边就显示全数据(个人理解:加号表示可扩展的意思)
select *
from emp e,dept d
where e.deptno(+)=d.deptno;</code></pre><h2 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h2><p>自连接其实就是在不同的角度把一张表看成多张表</p>
<p><strong>查询出员工姓名,员工领导姓名(这两个都在同一张表)</strong></p>
<pre><code>select e1.ename,e2.ename
from emp e1,emp e2
where e1.mgr=e2.empno;</code></pre><p><strong>查询出员工姓名,员工部门名称,员工领导姓名,员工领导部门名称</strong></p>
<pre><code>select e1.ename,d1.dname,e2.ename,d2.dname
from emp e1,emp e2,dept d1,dept d2
where e1.mgr=e2.empno
and e1.deptno=d1.deptno
and e2.deptno=d2.deptno;</code></pre><p><strong>练习:查询出每个员工编号，姓名，部门名称，工资等级和他的上级领导的姓名，工资等级</strong></p>
<pre><code>select 
e1.empno 员工编号,e1.ename 员工姓名,
d.dname 部门姓名,s1.grade 工资等级,
e2.ename 领导姓名,s2.grade 领导工资等级
from emp e1,emp e2,dept d,salgrade s1,salgrade s2
where e1.mgr=e2.empno
and e1.deptno=d.deptno 
and e1.sal between s1.losal and s1.hisal
and e2.sal between s2.losal and s2.hisal</code></pre><h1 id="11-子查询"><a href="#11-子查询" class="headerlink" title="11.子查询"></a>11.子查询</h1><h2 id="返回一个值"><a href="#返回一个值" class="headerlink" title="返回一个值"></a>返回一个值</h2><pre><code>--查询出工资和scott一样的员工信息
select * from emp e where e.sal =
(select sal from emp where ename=&apos;SCOTT&apos;);</code></pre><h2 id="子查询返回一个集合"><a href="#子查询返回一个集合" class="headerlink" title="子查询返回一个集合"></a>子查询返回一个集合</h2><pre><code>--查询出工资和10号部门任意员工一样的员工信息
select * from emp where sal in
(select sal from emp where deptno=10);</code></pre><h2 id="子查询返回一张表"><a href="#子查询返回一张表" class="headerlink" title="子查询返回一张表"></a>子查询返回一张表</h2><pre><code>--查询出每个部门最低工资,和最低工资员工姓名,和该员工所在部门名称
--(1)先查询出每个部门最低工资
select deptno,min(sal) msal
from emp
group by deptno;

--(2)三表联查
select t.deptno,t.msal,e.ename,d.dname
from (select deptno,min(sal) msal
      from emp
      group by deptno) t,emp e,dept d
where t.deptno=e.deptno
and t.msal=e.sal
and e.deptno=d.deptno;</code></pre><h1 id="12-Oracle中的分页"><a href="#12-Oracle中的分页" class="headerlink" title="12.Oracle中的分页"></a>12.Oracle中的分页</h1><h2 id="rownum行号"><a href="#rownum行号" class="headerlink" title="rownum行号:"></a>rownum行号:</h2><p>当我们做select操作的时候,每查询出一行记录,就会在该行上加上一个行号,行号从1开始,依次递增,不可跳跃</p>
<pre><code>--员工工资倒序排行
--排序操作会影响rownum的顺序
select rownum,e.* from emp e order by e.sal desc;</code></pre><p><img src="https://i.loli.net/2019/10/12/JOCK1AWyc8TQXzj.png" alt="4.png"></p>
<pre><code>--如果涉及排序,但是要使用rownum,我们可以嵌套查询
select rownum,t.* from
(select rownum,e.* from emp e order by e.sal desc) t;</code></pre><p><img src="https://i.loli.net/2019/10/12/ZdfAQt6k4eyBNzG.png" alt="5.png"></p>
<pre><code>--emp工资倒序排列后,每页5条记录,查询第二页
--rownum行号不能写上大于一个整数
select * from(
  select rownum rn,t.* from(
         select * from emp order by sal desc
  ) t where rownum&lt;11
) where rn&gt;5;</code></pre><p><strong>rownum行号不能写上大于一个整数,可以起别名,简介令它大于一个正数(把原结果再次作为子表进行操作)</strong><br><img src="https://i.loli.net/2019/10/12/1wcTNv4GbS6eZpU.png" alt="6.png"></p>
<h1 id="13-视图"><a href="#13-视图" class="headerlink" title="13.视图"></a>13.视图</h1><p>概念:视图就是提供一个查询的窗口,所有数据来自于原表</p>
<h2 id="查询语句创建表-跨用户查询select-from-scott-emp"><a href="#查询语句创建表-跨用户查询select-from-scott-emp" class="headerlink" title="查询语句创建表(跨用户查询select * from scott.emp)"></a>查询语句创建表(跨用户查询select * from scott.emp)</h2><pre><code>create table emp as select * from scott.emp</code></pre><h2 id="创建视图-必须有dba权限"><a href="#创建视图-必须有dba权限" class="headerlink" title="创建视图(必须有dba权限)"></a>创建视图(必须有dba权限)</h2><pre><code>create view v_emp as select ename,job from emp; </code></pre><h2 id="修改视图-不推荐-会把原表也修改"><a href="#修改视图-不推荐-会把原表也修改" class="headerlink" title="修改视图(不推荐,会把原表也修改)"></a>修改视图(不推荐,会把原表也修改)</h2><pre><code>update v_emp set job=&apos;CLERK&apos; where ename=&apos;ALLEN&apos;;
commit;</code></pre><h2 id="创建只读视图"><a href="#创建只读视图" class="headerlink" title="创建只读视图"></a>创建只读视图</h2><pre><code>create view v_emp1 as select ename,job from emp with read only;</code></pre><h2 id="视图的作用"><a href="#视图的作用" class="headerlink" title="视图的作用"></a>视图的作用</h2><ol>
<li>视图可以屏蔽掉一些敏感字段</li>
<li>保证总部和分部数据及时统一</li>
</ol>
<h1 id="14-索引"><a href="#14-索引" class="headerlink" title="14.索引"></a>14.索引</h1><p>概念:在表的列上构建一个二叉树,达到大幅度提高查询效率的目的,但是索引会影响增删改的效率</p>
<h2 id="单例索引"><a href="#单例索引" class="headerlink" title="单例索引"></a>单例索引</h2><h3 id="创建单列索引"><a href="#创建单列索引" class="headerlink" title="创建单列索引"></a>创建单列索引</h3><pre><code>create index idx_ename on emp(ename);
--单列索引触发规则,条件必须是索引列中的原始值
--单行函数,模糊查询,都会影响索引的触发
select * from emp where ename=&apos;SCOTT&apos;</code></pre><h2 id="复合索引"><a href="#复合索引" class="headerlink" title="复合索引"></a>复合索引</h2><h3 id="创建复合索引"><a href="#创建复合索引" class="headerlink" title="创建复合索引"></a>创建复合索引</h3><pre><code>create index idx_enamejob on emp(ename,job);
--复合索引中第一列为优先检索列
--如果要触发复合索引,必须包含有优先检索列中的原始值
select * from emp where ename=&apos;SCOTT&apos; and job=&apos;xx&apos;;--触发复合索引
select * from emp where ename=&apos;SCOTT&apos; or job=&apos;xx&apos;;--不触发索引
select * from emp where ename=&apos;SCOTT&apos;;--触发单列索引(当这一列同时有单列索引与复合索引时)</code></pre><h1 id="15-pl-sql编程语言"><a href="#15-pl-sql编程语言" class="headerlink" title="15.pl/sql编程语言"></a>15.pl/sql编程语言</h1><p>特点:    </p>
<ol>
<li>pl/sql编程语言是对sql语言的扩展,使得sql语言具有过程化编程的特性  </li>
<li>比一般的过程化编程语言更加灵活高效  </li>
<li>主要用来编写存储过程和存储函数等  </li>
</ol>
<p>程序语法：</p>
<pre><code>declare
    说明部分 （变量说明，游标申明，例外说明 〕
begin
    语句序列 （DML语句〕…
exception
    例外处理语句
End;</code></pre><h2 id="声明与赋值"><a href="#声明与赋值" class="headerlink" title="声明与赋值"></a>声明与赋值</h2><pre><code>--声明方法
--赋值操作可以用:=也可以使用into查询语句赋值
declare
    i number(2) := 10; 
    s varchar2(10) := &apos;kobe&apos;; 
    ena emp.ename%type; --引用型变量:相当于把emp表中的ename列的数据类型取出   
    emprow emp%rowtype; --记录型变量
begin
    dbms_output.put_line(i);
    dbms_output.put_line(s);
    select ename into ena from emp where empno = 7788;
    dbms_output.put_line(ena);
    select * into emprow from emp where empno = 7788;
    --pl/sql编程语言的连接符为 ||而不是+
    dbms_output.put_line(emprow.ename || &apos;的工作为:&apos; || emprow.job);
end;</code></pre><h2 id="if判断"><a href="#if判断" class="headerlink" title="if判断"></a>if判断</h2><pre><code>--输入小于18的数字,输出未成年(&amp;代表由键盘输入)
--输入大于18小于40的数字,输出中年人
--输入大于40的数字,输出老年人
declare
    i number(3) := &amp;ii;
begin
  if i&lt;18 then
    dbms_output.put_line(&apos;未成年&apos;);

  elsif i&lt;40 then
    dbms_output.put_line(&apos;中年人&apos;);
  else
    dbms_output.put_line(&apos;老年人&apos;);    
  end if;
end;</code></pre><h2 id="loop循环"><a href="#loop循环" class="headerlink" title="loop循环"></a>loop循环</h2><p><strong>用三种方式输出1到10十个数字</strong></p>
<pre><code>--while
declare
  i number(2) :=1;
begin
  while i&lt;11 loop
        dbms_output.put_line(i);
        i := i+1;
  end loop;
end;

--exit 循环
declare
  i number(2) :=1;
begin
  loop
    exit when i&gt;10;
    dbms_output.put_line(i);
    i := i+1;
  end loop;
end;

--for循环
declare

begin
  for i in 1..10 loop
    dbms_output.put_line(i);
  end loop;
end;</code></pre><h2 id="游标-可以存放多个对象-多行记录"><a href="#游标-可以存放多个对象-多行记录" class="headerlink" title="游标:可以存放多个对象,多行记录"></a>游标:可以存放多个对象,多行记录</h2><p>游标的使用步骤：  </p>
<ol>
<li>打开游标： open c1; (打开游标执行查询)  </li>
<li>取一行游标的值：fetch c1 into pjob; (取一行到变量中)  </li>
<li>关闭游标： close c1;(关闭游标释放资源)  </li>
<li>游标的结束方式 exit when c1%notfound  </li>
</ol>
<pre><code>--输出emp表中所有员工的姓名
declare
  cursor c1 is select * from emp;
  emprow emp%rowtype;
begin
  open c1;
       loop
         fetch c1 into emprow;
         exit when c1%notfound;
         dbms_output.put_line(emprow.ename);
       end loop;
  close c1;
end;

--给指定部门员工涨工资(带参的游标)
declare
       cursor c2(eno emp.deptno%type)
       is select empno from emp where deptno=eno;
       en emp.empno%type;
begin
  open c2(10);
       loop
          fetch c2 into en;
          exit when c2%notfound;
          update emp set sal=sal+100 where empno=en;
          commit;
       end loop;
  close c2;
end;</code></pre><h2 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h2><p><strong>概念:存储过程就是提前编译好的一段pl/sql语言,放置在数据库端,可以直接被调用,这一段pl/sql一般都是固定步骤的业务.</strong></p>
<p>创建存储过程语法：</p>
<pre><code>create [or replace] PROCEDURE 过程名[(参数名 in/out 数据类型)]
AS
begin
    PLSQL子程序体；
End;</code></pre><p>案例演示:</p>
<pre><code>--给指定员工涨100块钱
create or replace procedure p1(eno emp.empno%type)
as

begin
  update emp set sal=sal+100 where empno=eno;
  commit;
end;

select * from emp where empno=7788;
--测试p1
declare

begin
  p1(7788);
end;</code></pre><h2 id="存储函数"><a href="#存储函数" class="headerlink" title="存储函数"></a>存储函数</h2><pre><code>create or replace function 函数名(Name in type, Name in type, ...) return 数据类型
 is
    结果变量 数据类型;
begin
    return(结果变量);
end函数名;</code></pre><p>通过存储函数实现计算指定员工的年薪<br>存储过程和存储函数的参数都不能带长度<br>存储函数的返回值类型不能带长度  </p>
<pre><code>create or replace function f_yearsal(eno emp.empno%type) return number
as
  s number(10);
begin
  select sal*12+nvl(comm,0) into s from emp where empno = eno;
  return s;
end;</code></pre><p>测试f_yearsal<br>存储函数在调用的时候,返回值需要接收  </p>
<pre><code>declare
  s number(10);
begin
  s := f_yearsal(7788);
  dbms_output.put_line(s);
end;</code></pre><h2 id="out类型参数的使用"><a href="#out类型参数的使用" class="headerlink" title="out类型参数的使用"></a>out类型参数的使用</h2><pre><code>--使用存储过程来算年薪
create or replace procedure p_pyearsal(eno emp.empno%type,yearsal out number)
is
  s number(10);
  c emp.comm%type;
begin
  select sal*12,nvl(comm,0) into s,c from emp where empno=eno;
  yearsal :=s+c;
end;


--测试p_pyearsal
declare
  s number(10);
begin
  p_pyearsal(7788,s);
  dbms_output.put_line(s);
end;</code></pre><p><strong>in和out类型参数的区别:<br>凡是涉及到into查询语句赋值或者:=赋值操作的参数,都必须用out来修饰</strong></p>
<h2 id="存储过程和存储函数的区别"><a href="#存储过程和存储函数的区别" class="headerlink" title="存储过程和存储函数的区别"></a>存储过程和存储函数的区别</h2><ol>
<li>语法区别:关键字不一样,函数比过程多了两个return</li>
<li><strong>本质区别:存储函数有返回值,而存储过程没返回值<br>(如果存储过程想实现有返回值的业务,就必须使用out类型的参数;即便是存储过程使用了out类型的参数,其本质也不是真的有了返回值,而是在存储过程内部给out类型参数赋值,在执行完毕后,我们直接拿到输出类型参数的值)</strong></li>
<li>我们可以使用存储函数有返回值的特性,来自定义函数.而存储过程不能用来自定义函数</li>
</ol>
<p>案例:查询出员工姓名,员工所在部门名称</p>
<p>传统方式实现:</p>
<pre><code>select e.ename,d.dname
from emp e,dept d
where e.deptno=d.deptno;</code></pre><p>使用存储函数实现:</p>
<pre><code>--创建一个存储函数提供一个部门编号,输出一个部门名称
create or replace function asd(dno dept.deptno%type)return dept.dname%type
is
    dna dept.dname%type; 
begin
  select dname into dna from dept where deptno=dno;
  return dna;
end;

--使用asd存储函数来实现案例需求:查询出员工姓名,员工所在部门名称
select ename,asd(deptno)
from emp;</code></pre><h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>定义:就是制定一个规则,在我们做增删改操作的时候,只要满足该规则,自动触发,无需调用.</p>
<p>**两类触发器:  </p>
<ol>
<li>语句级触发器:不包含有for each row  </li>
<li>行级触发器:包含有for each row的就是行级触发器**</li>
</ol>
<p>加for each row是为了使用:old或者:new对象或者一行记录<br><img src="https://i.loli.net/2019/10/12/VHrnIFP2Byog1cT.png" alt="7.png"></p>
<p><strong>语句级触发器案例</strong></p>
<pre><code>--插入一条记录,输出一个新员工入职
create or replace trigger t1
after--插入后执行
insert--哪种语句
on person--往哪张表插
declare 

begin
  dbms_output.put_line(&apos;一个新员工入职&apos;);
end;
--触发t1
insert into person values(24,&apos;科比&apos;);
commit;</code></pre><p><strong>行级别触发器案例</strong></p>
<pre><code>--不能给员工降薪
--raise_application_error(-20001~-20999之间,&apos;错误提示信息&apos;);
create or replace trigger t2
before--更新前执行
update--使用更新语句
on emp--在哪张表更新
for each row--用来提取旧数据和新数据
declare

begin
  if :old.sal&gt;:new.sal then
    raise_application_error(-20001,&apos;不能给员工降薪&apos;);
  end if;
end;

--触发t2
update emp set sal=sal-1 where empno=7788;
commit; </code></pre><p><img src="https://i.loli.net/2019/10/12/WSlq4Jr3DOQcGIv.png" alt="8.png"></p>
<h2 id="触发器实现主键自增"><a href="#触发器实现主键自增" class="headerlink" title="触发器实现主键自增"></a>触发器实现主键自增</h2><p><strong>分析:在用户做插入操作之前,拿到即将插入的数据,给该数据中的主键列赋值</strong></p>
<pre><code>--s_person.nextval是之前创建的序列,采取增长nextval,赋值给:new将要插入的数据
create or replace trigger auid
before
insert
on person
for each row
declare

begin
  select s_person.nextval into :new.pid from dual;
end;

--使用auid实现主键自增
insert into person (pname) values (&apos;布莱恩特&apos;);
commit;</code></pre><h1 id="16-java调用存储过程和存储函数"><a href="#16-java调用存储过程和存储函数" class="headerlink" title="16.java调用存储过程和存储函数"></a>16.java调用存储过程和存储函数</h1><p>Oracle版本与对应的jar包<br>oracle10g—ojdbc14.jar<br>oracle11g—ojdbc6.jar</p>
<p>使用IDEA创建一个MAVEN工程.<br>导入依赖坐标:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.kobe&lt;/groupId&gt;
    &lt;artifactId&gt;jdbc_oracle&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.oracle&lt;/groupId&gt;
            &lt;artifactId&gt;ojdbc14&lt;/artifactId&gt;
            &lt;version&gt;10.2.0.4.0&lt;/version&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;


&lt;/project&gt;</code></pre><p>进行简单测试:</p>
<pre><code>public class OracleDemo {

    @Test
    public void javaCallOracle() throws Exception {
        //加载数据库驱动
        Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);
        //得到Connection连接
        Connection con = DriverManager.getConnection(&quot;jdbc:oracle:thin:localhost:1521:orcl&quot;, &quot;kobe&quot;, &quot;kobe&quot;);
        //得到预编译的Statement对象
        PreparedStatement pstm = con.prepareStatement(&quot;select * from emp where empno = ?&quot;);
        //给参数赋值
        pstm.setObject(1,7788);
        //执行
        ResultSet rs = pstm.executeQuery();
        //输出结果
        while(rs.next()) {
            System.out.println(rs.getString(&quot;ename&quot;));
        }
        //释放资源
        rs.close();
        pstm.close();
        con.close();
    }
}</code></pre><p><img src="https://i.loli.net/2019/10/12/Wqlht5fTuSRVPMg.png" alt="9.png"></p>
<p>##java调用存储过程<br>    /**<br>     * java调用存储过程<br>     * 接口CallableStatement是给sql存储过程和存储函数使用的<br>     * @throws Exception<br>     */<br>    @Test<br>    public void javaCallProcedure() throws Exception {<br>        //加载数据库驱动<br>        Class.forName(“oracle.jdbc.driver.OracleDriver”);<br>        //得到Connection连接<br>        Connection con = DriverManager.getConnection(“jdbc:oracle:thin:localhost:1521:orcl”, “kobe”, “kobe”);<br>        //得到预编译的Statement对象<br>        CallableStatement ctm = con.prepareCall(“{call p_pyearsal(?,?)}”);<br>        //给参数赋值<br>        ctm.setObject(1,7788);<br>        ctm.registerOutParameter(2, OracleTypes.NUMBER);<br>        //执行<br>        ctm.execute();<br>        //输出结果(第二个参数)<br>        System.out.println(ctm.getObject(2));<br>        //释放资源<br>        ctm.close();<br>        con.close();<br>    }</p>
<h2 id="java调用存储函数"><a href="#java调用存储函数" class="headerlink" title="java调用存储函数"></a>java调用存储函数</h2><pre><code>/**
 * java调用存储函数
 * 接口CallableStatement是给sql存储过程和存储函数使用的
 * @throws Exception
 */
@Test
public void javaCallFunction() throws Exception {
    //加载数据库驱动
    Class.forName(&quot;oracle.jdbc.driver.OracleDriver&quot;);
    //得到Connection连接
    Connection con = DriverManager.getConnection(&quot;jdbc:oracle:thin:localhost:1521:orcl&quot;, &quot;kobe&quot;, &quot;kobe&quot;);
    //得到预编译的Statement对象
    CallableStatement ctm = con.prepareCall(&quot;{? = call f_yearsal(?)}&quot;);
    //给参数赋值
    ctm.setObject(2,7788);
    ctm.registerOutParameter(1, OracleTypes.NUMBER);
    //执行
    ctm.execute();
    //输出结果(第一个参数)
    System.out.println(ctm.getObject(1));
    //释放资源
    ctm.close();
    con.close();
}</code></pre>
    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/Oracle/" rel="tag"># Oracle</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/10/12/Maven分模块构建/" rel="next" title="Maven分模块构建">
                  <i class="fa fa-chevron-left"></i> Maven分模块构建
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/10/12/Spring-Data-JPA/" rel="prev" title="Spring Data JPA">
                  Spring Data JPA <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
    <div class="comments" id="comments"></div>
  

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Oracle体系结构"><span class="nav-number">1.</span> <span class="nav-text">1.Oracle体系结构</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-表空间与用户的创建"><span class="nav-number">2.</span> <span class="nav-text">2.表空间与用户的创建</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Oracle数据类型"><span class="nav-number">3.</span> <span class="nav-text">3.Oracle数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Varchar，-varchar2"><span class="nav-number">3.1.</span> <span class="nav-text">Varchar， varchar2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NUMBER"><span class="nav-number">3.2.</span> <span class="nav-text">NUMBER</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DATA"><span class="nav-number">3.3.</span> <span class="nav-text">DATA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CLOB"><span class="nav-number">3.4.</span> <span class="nav-text">CLOB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BLOB"><span class="nav-number">3.5.</span> <span class="nav-text">BLOB</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-表的管理"><span class="nav-number">4.</span> <span class="nav-text">4.表的管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#表的创建"><span class="nav-number">4.1.</span> <span class="nav-text">表的创建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表的增删改"><span class="nav-number">4.2.</span> <span class="nav-text">表的增删改</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-序列"><span class="nav-number">5.</span> <span class="nav-text">5.序列</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Scott用户下的表结构"><span class="nav-number">6.</span> <span class="nav-text">6.Scott用户下的表结构</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-单行函数"><span class="nav-number">7.</span> <span class="nav-text">7.单行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-字符函数"><span class="nav-number">7.1.</span> <span class="nav-text">7.1 字符函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-数值函数"><span class="nav-number">7.2.</span> <span class="nav-text">7.2 数值函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-日期函数"><span class="nav-number">7.3.</span> <span class="nav-text">7.3 日期函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-转换函数"><span class="nav-number">7.4.</span> <span class="nav-text">7.4 转换函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-5-通用函数"><span class="nav-number">7.5.</span> <span class="nav-text">7.5 通用函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-6-条件表达式"><span class="nav-number">7.6.</span> <span class="nav-text">7.6 条件表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#通用写法-mysql和Oracle通用"><span class="nav-number">7.6.1.</span> <span class="nav-text">通用写法(mysql和Oracle通用)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Oracle专用表达式"><span class="nav-number">7.7.</span> <span class="nav-text">Oracle专用表达式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-多行函数-聚合函数"><span class="nav-number">8.</span> <span class="nav-text">8.多行函数(聚合函数)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-分组查询"><span class="nav-number">9.</span> <span class="nav-text">9.分组查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#重点-where是过滤分组前的数据-having是过滤分组后的数据"><span class="nav-number">9.1.</span> <span class="nav-text">重点:where是过滤分组前的数据,having是过滤分组后的数据</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-多表查询中的一些概念"><span class="nav-number">10.</span> <span class="nav-text">10. 多表查询中的一些概念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#笛卡尔积"><span class="nav-number">10.1.</span> <span class="nav-text">笛卡尔积</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#等值连接"><span class="nav-number">10.2.</span> <span class="nav-text">等值连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内连接"><span class="nav-number">10.3.</span> <span class="nav-text">内连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#外连接"><span class="nav-number">10.4.</span> <span class="nav-text">外连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#oracle中专用外连接"><span class="nav-number">10.5.</span> <span class="nav-text">oracle中专用外连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自连接"><span class="nav-number">10.6.</span> <span class="nav-text">自连接</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-子查询"><span class="nav-number">11.</span> <span class="nav-text">11.子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#返回一个值"><span class="nav-number">11.1.</span> <span class="nav-text">返回一个值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询返回一个集合"><span class="nav-number">11.2.</span> <span class="nav-text">子查询返回一个集合</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询返回一张表"><span class="nav-number">11.3.</span> <span class="nav-text">子查询返回一张表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-Oracle中的分页"><span class="nav-number">12.</span> <span class="nav-text">12.Oracle中的分页</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#rownum行号"><span class="nav-number">12.1.</span> <span class="nav-text">rownum行号:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#13-视图"><span class="nav-number">13.</span> <span class="nav-text">13.视图</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#查询语句创建表-跨用户查询select-from-scott-emp"><span class="nav-number">13.1.</span> <span class="nav-text">查询语句创建表(跨用户查询select * from scott.emp)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建视图-必须有dba权限"><span class="nav-number">13.2.</span> <span class="nav-text">创建视图(必须有dba权限)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改视图-不推荐-会把原表也修改"><span class="nav-number">13.3.</span> <span class="nav-text">修改视图(不推荐,会把原表也修改)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建只读视图"><span class="nav-number">13.4.</span> <span class="nav-text">创建只读视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#视图的作用"><span class="nav-number">13.5.</span> <span class="nav-text">视图的作用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#14-索引"><span class="nav-number">14.</span> <span class="nav-text">14.索引</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#单例索引"><span class="nav-number">14.1.</span> <span class="nav-text">单例索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建单列索引"><span class="nav-number">14.1.1.</span> <span class="nav-text">创建单列索引</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#复合索引"><span class="nav-number">14.2.</span> <span class="nav-text">复合索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建复合索引"><span class="nav-number">14.2.1.</span> <span class="nav-text">创建复合索引</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#15-pl-sql编程语言"><span class="nav-number">15.</span> <span class="nav-text">15.pl/sql编程语言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#声明与赋值"><span class="nav-number">15.1.</span> <span class="nav-text">声明与赋值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#if判断"><span class="nav-number">15.2.</span> <span class="nav-text">if判断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#loop循环"><span class="nav-number">15.3.</span> <span class="nav-text">loop循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#游标-可以存放多个对象-多行记录"><span class="nav-number">15.4.</span> <span class="nav-text">游标:可以存放多个对象,多行记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#存储过程"><span class="nav-number">15.5.</span> <span class="nav-text">存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#存储函数"><span class="nav-number">15.6.</span> <span class="nav-text">存储函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#out类型参数的使用"><span class="nav-number">15.7.</span> <span class="nav-text">out类型参数的使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#存储过程和存储函数的区别"><span class="nav-number">15.8.</span> <span class="nav-text">存储过程和存储函数的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#触发器"><span class="nav-number">15.9.</span> <span class="nav-text">触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#触发器实现主键自增"><span class="nav-number">15.10.</span> <span class="nav-text">触发器实现主键自增</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#16-java调用存储过程和存储函数"><span class="nav-number">16.</span> <span class="nav-text">16.java调用存储过程和存储函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#java调用存储函数"><span class="nav-number">16.1.</span> <span class="nav-text">java调用存储函数</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/1.gif"
      alt="月月鸟">
  <p class="site-author-name" itemprop="name">月月鸟</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/Moon-Moon-Bird" title="GitHub &rarr; https://github.com/Moon-Moon-Bird" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/903286240@qq.com" title="E-Mail &rarr; 903286240@qq.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



      </div>
	  
	  <div id="music163player">
		<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=524149927&auto=1&height=66">
		</iframe>
	  </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">月月鸟</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">105k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">1:35</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='200' src="/lib/canvas-nest/canvas-nest-nomobile.min.js"></script>
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/pisces.js?v=7.4.1"></script>
<script src="/js/next-boot.js?v=7.4.1"></script>



  








  <script src="/js/local-search.js?v=7.4.1"></script>














  

  

  


<script>
NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: false,
    notify: false,
    appId: '7hWmSrhY0rne8BX9kLc1waeP-gzGzoHsz',
    appKey: 'xoHWFrk6WDuBSi6M83Iy25vl',
    placeholder: '香港是中国的!',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn',
    path: location.pathname,
    recordIP: false,
    serverURLs: ''
  });
}, window.Valine);
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>
</html>
